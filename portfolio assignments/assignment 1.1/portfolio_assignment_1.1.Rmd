---
title: "portfolio_assignment_1.1"
author: "Youri Lam"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
library(readxl)
library(tidyverse)
library(toolboxr)
library(patchwork)
library(cowplot)
library(devtools)
library(here)
devtools::install_github("uashogeschoolutrecht/toolboxr")
```
```

Assignment 1.1

``` {r importing and checking data types}
dataset_elegans <- read_excel(here("raw_data/CE.LIQ.FLOW.062_Tidydata.xlsx"))
typeof(dataset_elegans$RawData)
typeof(dataset_elegans$compName)
typeof(dataset_elegans$compConcentration)
```

Before the data can be visualized, it has to be cleaned up. The dataframe is already in tidy format, but the data types of the columns need to be changed. The variables RawData (the outcome - number of offspring counted as an integer value, after incubation time), compName (the generic name of the compound/chemical) and the compConcentration (the concentration of the compound) are all very important in this research. Expected data types would be double/integer for RawData, character for compName and double for compConcentration. The actual data types of the columns are double for RawData, character for compName and character for compConcentration, as seen above. When plotted, this will result in the following issue: 

```{r errorplot, warning=FALSE, fig.cap="Number of C. elegans offspring under a number of circumstances where the x-axis is ordered alphabetically"}

plot_wrong <- ggplot(data = dataset_elegans, aes(x = compConcentration, y = RawData))+
  geom_point(aes(color = compName,
                 shape = expType),
             size = 1)+
  rotate_axis_labels("x", 90)+
  labs(x = "Concentration",
       y = "Number of offspring",
       title = "Number of offspring of adult Elegans were exposed to varying concentrations of different compounds, alphabetical",
       shape = "Type",
       color = "Compound")
plot_wrong
```

As seen in the figure above, the x-axis labels are ordered alphabetically. This is because the data type of the compConcentration is character instead of double.By changing the date types to the correct ones and adding jitter, we can make the graph look like this:


Because of the concentration levels being so incredibly low, everything is super close together. 

```{r opdracht1 graph2}
dataset_elegans$compConcentration <- jitter(dataset_elegans$compConcentration, 2)
ggplot(data = dataset_elegans, aes(x = compConcentration, y = RawData)) +
  geom_point(aes(color = compName,
                 shape = expType),
             size = 3,alpha = 0.8) +
  scale_x_continuous(trans='log10') +
  labs(title = "Number of offspring of adult Elegans were exposed to varying concentrations of different compounds",
       x = "Concentration of the compound",
       y = "Number of offsprings counted")
```

The positive control for this experiments is 2,6-diisopropylnaphthalene. The negative control for this experiment is Ethanol. 

To learn whether there is indeed an effect of different concentrations on offspring count I would apply a t-test for each concentration to see wether there is a significant statistically difference.

The result has to be normalised in order to filter the natural expression. S-medium is the negative control, so this will be used as a blanc.